<?php

use App\Http\Controllers\ProfileController;
use App\Http\Controllers\AdminController;
use Illuminate\Support\Facades\Route;
use Illuminate\Support\Facades\Auth;

Route::get('/', function () {
    return view('welcome');
});

Route::get('/dashboard', function () {
    return view('dashboard');
})->middleware(['auth', 'verified'])->name('dashboard');

// 🔐 Grup route khusus admin (wajib login)
Route::middleware(['auth'])->group(function () {

    // Dashboard admin utama
    Route::get('/admin/dashboard', [AdminController::class, 'index'])->name('admin.dashboard');

  // Halaman-halaman admin
Route::get('/admin/permohonan', [AdminController::class, 'permohonan'])->name('admin.permohonan');
Route::get('/admin/surat', [AdminController::class, 'datasurat'])->name('admin.surat');
Route::get('/admin/datasurat/{id}', [AdminController::class, 'detailSurat'])->name('admin.detail-surat');
Route::get('/admin/ttddigital', [AdminController::class, 'ttddigital'])->name('admin.ttddigital');
Route::post('/admin/tanda-tangan/upload', [AdminController::class, 'uploadTandaTangan'])->name('admin.tanda.tangan.upload'); // 💥 tambahkan ini
// ✍️ Halaman untuk menandatangani surat (form tanda tangan)
Route::get('/admin/tanda-tangan/{id}', [AdminController::class, 'tandaTangan'])->name('admin.tanda.tangan');

// ✅ Halaman konfirmasi tanda tangan
Route::get('/admin/tanda-tangan/konfirmasi/{id}', [AdminController::class, 'konfirmasiTandaTangan'])->name('admin.tanda.tangan.konfirmasi');
Route::get('/admin/surat/{id}/preview', [AdminController::class, 'tampilkanSurat'])->name('admin.surat.preview');

Route::get('/admin/profiladmin', [AdminController::class, 'profiladmin'])->name('admin.profiladmin');

    // Tombol logout
    Route::post('/logout', function () {
        Auth::logout();
        return redirect('/login');
    })->name('logout');
});

// 🔧 Route profil default Laravel Breeze
Route::middleware('auth')->group(function () {
    Route::get('/profile', [ProfileController::class, 'edit'])->name('profile.edit');
    Route::patch('/profile', [ProfileController::class, 'update'])->name('profile.update');
    Route::delete('/profile', [ProfileController::class, 'destroy'])->name('profile.destroy');
});

require __DIR__.'/auth.php';
